"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.withPortableText = void 0;

var _operationToPatches = require("../utils/operationToPatches");

var _plugins = require("./plugins");

var withPortableText = (editor, options) => {
  var e = editor;
  e.maxBlocks = options.maxBlocks || -1;
  e.readOnly = options.readOnly || false;
  var portableTextFeatures = options.portableTextFeatures,
      keyGenerator = options.keyGenerator,
      change$ = options.change$,
      incomingPatches$ = options.incomingPatches$;
  var operationToPatches = (0, _operationToPatches.createOperationToPatches)(portableTextFeatures);
  var withObjectKeys = (0, _plugins.createWithObjectKeys)(portableTextFeatures, keyGenerator);
  var withSchemaTypes = (0, _plugins.createWithSchemaTypes)(portableTextFeatures);
  var withPatches = (0, _plugins.createWithPatches)(operationToPatches, change$, portableTextFeatures, incomingPatches$);
  var withMaxBlocks = (0, _plugins.createWithMaxBlocks)();
  var withPortableTextLists = (0, _plugins.createWithPortableTextLists)(portableTextFeatures);
  var withUndoRedo = (0, _plugins.createWithUndoRedo)(incomingPatches$);
  var withPortableTextMarkModel = (0, _plugins.createWithPortableTextMarkModel)(portableTextFeatures);
  var withPortableTextBlockStyle = (0, _plugins.createWithPortableTextBlockStyle)(portableTextFeatures, change$);
  var withUtils = (0, _plugins.createWithUtils)(portableTextFeatures);
  var withPortableTextSelections = (0, _plugins.createWithPortableTextSelections)(change$); // Ordering is important here, selection dealing last, data manipulation in the middle and core model stuff first.

  return withSchemaTypes(withObjectKeys(withPortableTextMarkModel(withPortableTextBlockStyle(withPortableTextLists(withUtils(withMaxBlocks(withUndoRedo(withPatches(withPortableTextSelections(e))))))))));
};

exports.withPortableText = withPortableText;